# План реализации Telegram-бота для 360‑градусного фидбэка

## Ключевые архитектурные решения
*   **Среды выполнения**: Проект будет поддерживать две среды: `Test` для разработки и отладки и `Production` для боевой эксплуатации. Конфигурация (токены, ID таблиц) будет управляться через переменные окружения (файл `.env`).

## Общее количество шагов
Всего **9 шагов** от скелета проекта до полной функциональности.

| Step | Статус | Краткое описание | Ожидаемый результат | Критерий завершения |
|------|--------|------------------|---------------------|---------------------|
| **1** | ✅ Готово | **Архитектура и окружение**: Создание структуры проекта, установка зависимостей (`aiogram`, `gspread`, `redis`), настройка конфигурации для сред `Test`/`Production`. | Базовая структура проекта создана, зависимости установлены, конфигурация готова к использованию. | Структура проекта и зависимости закоммичены в удаленный репозиторий. |
| **2** | ⏳ В процессе | **Базовый бот**: Реализация команд `/start`, `/help`, `/status` и подключение к Google Sheets для чтения справочника. | Рабочий бот, реагирующий в чате; успешное чтение таблицы `Employees`. | HR вводит `/status` → ответ «Активных циклов нет». |
| **3** | ❌ Не начато | **Создание цикла**: Команда `/new_cycle` (ввод данных, проверка лимита, создание листа). | Создан лист `YYYY-MM-DD_Target`, бот пишет «Цикл создан». | Новый лист виден в Google Sheets. |
| **4** | ❌ Не начато | **Ссылки и назначения**: Генерация персональных ссылок респондентов, хранение назначений. | HR получает список ссылок; связка `Cycle_ID–Respondent_ID` сохранена. | Запись связки в хранилище. |
| **5** | ❌ Не начато | **Форма респондента**: Показ анкеты, валидация, сохранение черновика. | Респондент заполняет форму; может вернуться к черновику. | Сабмит сохраняет строку в листе. |
| **6** | ❌ Не начато | **Очередность анкет**: Новая анкета выдаётся только после сабмита предыдущей. | Исключён параллельный обход форм. | Тест с двумя назначениями — работает корректно. |
| **7** | ❌ Не начато | **Таймеры и сводки**: Напоминания респондентам и ежедневная HR‑сводка. | HR получает сводку; респонденты — пинги. | Сообщения приходят по расписанию. |
| **8** | ❌ Не начато | **Итоговый отчёт**: Автогенерация отчёта (markdown + CSV) после дедлайна. | HR получает отчёт с средними, буллетами, GPT‑цитатами. | Формат отчёта соответствует ТЗ. |
| **9** | ❌ Не начато | **Завершение**: Команды `/cancel`, расширенный `/status`; логирование. | HR может отменить цикл, видеть прогресс; логи пишутся. | Все команды работают в тестах. |

---

## Логика статусов

| Статус | Описание |
|--------|----------|
| **Draft** | Цикл создан, ждёт начала сбора. |
| **Collecting** | Идёт сбор анкет. |
| **Closed** | Дедлайн прошёл или цикл отменён. |
| **Reported** | Итоговый отчёт отправлен HR. |

---

## Напоминания и таймеры (МСК)

* Пинг респондентам — каждые 3 дня после запуска цикла.  
* Финальный пинг — за 2 дня до дедлайна.  
* HR‑сводка — ежедневно в 09:00.

---

## Команды HR

```
/new_cycle
/cancel <Cycle_ID>
/status
/help
```

---

> Все текстовые сообщения бота и интерфейс — **на русском языке**.
